///============================================================================
/// Theme Nova — Dark Mode
/// Applied when html.nova-dark is present
///============================================================================

html.nova-dark {
    // ─── Override CSS Custom Properties (Discord-inspired palette) ──────
    // Surfaces — 2 main tones: bg/bg-alt share the dark base, surface is lighter
    --nova-bg: #2b2d31;
    --nova-bg-alt: #2e3035;
    --nova-surface: #313338;
    --nova-surface-raised: #383a40;
    --nova-surface-overlay: #313338;

    // Text
    --nova-text: #f2f3f5;
    --nova-text-secondary: #b5bac1;
    --nova-text-tertiary: #949ba4;
    --nova-text-inverse: #2b2d31;

    // Borders
    --nova-border: #3f4147;
    --nova-border-light: #35373c;
    --nova-border-focus: #5865f2;

    // Accent (Discord blurple)
    --nova-accent: #5865f2;
    --nova-accent-hover: #7289da;
    --nova-accent-light: rgba(88, 101, 242, 0.15);
    --nova-accent-medium: rgba(88, 101, 242, 0.25);

    // Semantic
    --nova-success: #23a55a;
    --nova-success-light: rgba(35, 165, 90, 0.15);
    --nova-warning: #f0b232;
    --nova-warning-light: rgba(240, 178, 50, 0.15);
    --nova-danger: #da373c;
    --nova-danger-light: rgba(218, 55, 60, 0.15);
    --nova-info: #00a8fc;
    --nova-info-light: rgba(0, 168, 252, 0.15);

    // Shadows
    --nova-shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.24);
    --nova-shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.32), 0 1px 2px rgba(0, 0, 0, 0.24);
    --nova-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.32), 0 2px 4px -2px rgba(0, 0, 0, 0.28);
    --nova-shadow-md: 0 8px 16px -4px rgba(0, 0, 0, 0.4), 0 4px 6px -2px rgba(0, 0, 0, 0.32);
    --nova-shadow-lg: 0 20px 40px -8px rgba(0, 0, 0, 0.5), 0 8px 16px -4px rgba(0, 0, 0, 0.4);
    --nova-shadow-xl: 0 24px 48px -12px rgba(0, 0, 0, 0.6);

    // ─── Accent color variants (dark) ──────────────────────────────────
    &[data-nova-accent="blue"] {
        --nova-accent: #60A5FA;
        --nova-accent-hover: #93C5FD;
        --nova-accent-light: rgba(96, 165, 250, 0.15);
        --nova-accent-medium: rgba(96, 165, 250, 0.25);
    }
    &[data-nova-accent="emerald"] {
        --nova-accent: #34D399;
        --nova-accent-hover: #6EE7B7;
        --nova-accent-light: rgba(52, 211, 153, 0.15);
        --nova-accent-medium: rgba(52, 211, 153, 0.25);
    }
    &[data-nova-accent="rose"] {
        --nova-accent: #FB7185;
        --nova-accent-hover: #FDA4AF;
        --nova-accent-light: rgba(251, 113, 133, 0.15);
        --nova-accent-medium: rgba(251, 113, 133, 0.25);
    }
    &[data-nova-accent="amber"] {
        --nova-accent: #FBBF24;
        --nova-accent-hover: #FCD34D;
        --nova-accent-light: rgba(251, 191, 36, 0.15);
        --nova-accent-medium: rgba(251, 191, 36, 0.25);
    }
    &[data-nova-accent="violet"] {
        --nova-accent: #A78BFA;
        --nova-accent-hover: #C4B5FD;
        --nova-accent-light: rgba(167, 139, 250, 0.15);
        --nova-accent-medium: rgba(167, 139, 250, 0.25);
    }

    // ═══════════════════════════════════════════════════════════════════
    // GLOBAL BASE
    // ═══════════════════════════════════════════════════════════════════

    color-scheme: dark;

    body {
        background-color: var(--nova-bg) !important;
        color: var(--nova-text) !important;
    }

    .o_web_client {
        background-color: var(--nova-bg) !important;
        color: var(--nova-text) !important;
    }

    .o_action_manager {
        background-color: var(--nova-bg) !important;
    }

    .o_content {
        background-color: var(--nova-bg) !important;
    }

    // ═══════════════════════════════════════════════════════════════════
    // NAVBAR
    // ═══════════════════════════════════════════════════════════════════

    .o_main_navbar {
        background: var(--nova-surface) !important;
        border-bottom-color: var(--nova-border) !important;
        color: var(--nova-text) !important;

        .o_menu_brand {
            color: var(--nova-text) !important;
        }

        .o_menu_sections {
            > .o_nav_entry,
            > .dropdown > .dropdown-toggle {
                color: var(--nova-text-secondary) !important;

                &:hover, &.active, &.show {
                    color: var(--nova-accent) !important;
                }
            }
        }

        .o_menu_systray {
            .dropdown-toggle,
            > li > a,
            .o_nav_entry {
                color: var(--nova-text-secondary) !important;

                &:hover {
                    color: var(--nova-accent) !important;
                }
            }

            .oe_topbar_name {
                color: var(--nova-text) !important;
            }
        }
    }

    .nova-apps-button {
        color: var(--nova-text-secondary) !important;

        &:hover {
            color: var(--nova-text) !important;
        }
    }

    // Systray badges in dark mode
    .o_menu_systray .badge {
        border-color: var(--nova-surface) !important;
    }

    // ═══════════════════════════════════════════════════════════════════
    // SYSTRAY DROPDOWNS (Messaging + Activities)
    // ═══════════════════════════════════════════════════════════════════

    // Generic bg-view — Odoo applies this on dropdown menus
    .bg-view {
        background-color: var(--nova-surface) !important;
    }

    // ─── Activity Menu ────────────────────────────────────────────────
    .o_menu_systray .o_ActivityMenuView {
        .o_ActivityMenuView_dropdownMenu {
            background-color: var(--nova-surface) !important;
            border-color: var(--nova-border) !important;
            color: var(--nova-text) !important;
        }

        .o_ActivityMenuView_activityGroup {
            color: var(--nova-text) !important;
            background-color: transparent !important;
            border-bottom-color: var(--nova-border) !important;

            &:hover {
                background-color: var(--nova-accent-light) !important;
            }

            // Override "text-muted" and all nested text
            span, button, div {
                color: var(--nova-text-secondary) !important;
            }
        }

        .o_ActivityMenuView_activityGroupName {
            color: var(--nova-text) !important;
        }

        .o_ActivityMenuView_activityGroupFilterButton {
            color: var(--nova-accent) !important;
        }

        .o_ActivityMenuView_activityGroupNoCount {
            color: var(--nova-text-tertiary) !important;
        }

        .o_ActivityMenuView_noActivity {
            color: var(--nova-text-tertiary) !important;
        }
    }

    // ─── Messaging Menu ───────────────────────────────────────────────
    .o_menu_systray .o_MessagingMenu {
        // Dropdown container
        .o_MessagingMenu_dropdownMenu {
            background-color: var(--nova-surface) !important;
            border-color: var(--nova-border) !important;
            color: var(--nova-text) !important;
        }

        // Header with tabs
        .o_MessagingMenu_dropdownMenuHeader {
            border-bottom-color: var(--nova-border) !important;
        }

        // Tabs — override .text-dark from Odoo template
        .o_MessagingMenuTab {
            color: var(--nova-text-secondary) !important;

            &:hover {
                color: var(--nova-text) !important;
            }

            &.o-active {
                color: var(--nova-accent) !important;
            }

            // Kill .text-dark class applied by Odoo
            &.text-dark {
                color: var(--nova-text-secondary) !important;
            }
        }

        .o_MessagingMenu_newMessageButton {
            color: var(--nova-accent) !important;
        }
    }

    // ─── Notification list items (Messaging dropdown items) ──────────
    .o_NotificationListItem {
        background-color: var(--nova-surface) !important;
        color: var(--nova-text) !important;

        &:hover {
            background-color: var(--nova-surface-raised) !important;
        }

        &.o-muted {
            background-color: var(--nova-bg-alt) !important;

            &:hover {
                background-color: var(--nova-surface-raised) !important;
            }
        }

        // Person status icon bg must match item bg
        .o_NotificationListItem_personaImStatusIcon {
            color: var(--nova-surface) !important;
        }
    }

    // All text inside notification items
    .o_NotificationListItem_name,
    .o_ChannelPreviewView_name,
    .o_ThreadNeedactionPreview_name {
        color: var(--nova-text) !important;
    }

    .o_NotificationListItem_date,
    .o_ChannelPreviewView_date,
    .o_ThreadNeedactionPreview_date {
        color: var(--nova-text-tertiary) !important;
    }

    .o_NotificationListItem_inlineText,
    .o_ChannelPreviewView_messageBody,
    .o_ThreadNeedactionPreview_messageBody {
        color: var(--nova-text-secondary) !important;
    }

    .o_NotificationListItem_counter,
    .o_ChannelPreviewView_counter,
    .o_ThreadNeedactionPreview_counter {
        background-color: var(--nova-accent) !important;
        color: white !important;
    }

    .o_NotificationListItem_markAsRead {
        color: var(--nova-text-tertiary) !important;
        &:hover {
            color: var(--nova-accent) !important;
        }
    }

    .o_NotificationList_separator {
        border-color: var(--nova-border) !important;
    }

    .o_NotificationList_noConversation {
        color: var(--nova-text-tertiary) !important;
    }

    // Override .text-muted globally in systray dropdowns
    .o_menu_systray .text-muted {
        color: var(--nova-text-tertiary) !important;
    }

    // ─── Bootstrap DateTimePicker widget (calendar popup) ───────────
    .bootstrap-datetimepicker-widget {
        background-color: var(--nova-surface) !important;
        border-color: var(--nova-border) !important;

        .datepicker table {
            --datepicker-color: var(--nova-text);
            --datepicker__thead-bg: var(--nova-bg-alt);

            th, td {
                color: var(--nova-text) !important;
                border-color: var(--nova-border) !important;
            }

            thead tr:nth-child(2) th,
            td.cw {
                background-color: var(--nova-bg-alt) !important;
                color: var(--nova-text-secondary) !important;
            }

            td.old, td.new {
                color: var(--nova-text-tertiary) !important;
            }

            td.active {
                background-color: var(--nova-accent) !important;
                color: white !important;
            }

            td.today:not(.active) {
                color: var(--nova-accent) !important;
            }

            th.prev, th.next, th.picker-switch {
                color: var(--nova-text-secondary) !important;
                &:hover {
                    background-color: var(--nova-surface-raised) !important;
                }
            }
        }

        .timepicker-picker {
            background-color: var(--nova-surface) !important;

            span, td {
                color: var(--nova-text) !important;
            }
        }

        .accordion-toggle span.fa {
            color: var(--nova-text-secondary) !important;
            border-color: var(--nova-border) !important;
            box-shadow: none !important;
        }
    }

    // Note quick-create inside activity menu
    .o_note_show {
        .btn {
            color: var(--nova-text-secondary) !important;
        }
    }

    .o_note.o_ActivityMenuView_activityGroup {
        .o_note_input {
            background-color: var(--nova-surface-raised) !important;
            color: var(--nova-text) !important;
            border: 1px solid var(--nova-border) !important;
            border-radius: var(--nova-radius-sm);

            &::placeholder {
                color: var(--nova-text-tertiary) !important;
            }
        }

        .o_note_save {
            color: var(--nova-accent) !important;
        }
    }

    // ═══════════════════════════════════════════════════════════════════
    // SIDEBAR
    // ═══════════════════════════════════════════════════════════════════

    .nova-sidebar {
        background: var(--nova-surface) !important;
        border-right-color: var(--nova-border) !important;
    }

    // ═══════════════════════════════════════════════════════════════════
    // SCROLLBAR
    // ═══════════════════════════════════════════════════════════════════

    ::-webkit-scrollbar-thumb {
        background: var(--nova-text-tertiary);
        &:hover {
            background: var(--nova-text-secondary);
        }
    }

    ::selection {
        background: var(--nova-accent-medium);
        color: var(--nova-text);
    }

    // ═══════════════════════════════════════════════════════════════════
    // BOOTSTRAP OVERRIDES
    // ═══════════════════════════════════════════════════════════════════

    .bg-white,
    .bg-light,
    .bg-body {
        background-color: var(--nova-surface) !important;
    }

    .bg-100, .bg-200 {
        background-color: var(--nova-bg-alt) !important;
    }

    .text-dark {
        color: var(--nova-text) !important;
    }

    .text-muted {
        color: var(--nova-text-tertiary) !important;
    }

    .text-body {
        color: var(--nova-text) !important;
    }

    // Bootstrap text-NNN utilities (gray shades that are too dark in dark mode)
    .text-900, .text-800, .text-700 {
        color: var(--nova-text) !important;
    }

    .text-600 {
        color: var(--nova-text-secondary) !important;
    }

    .text-500, .text-400 {
        color: var(--nova-text-tertiary) !important;
    }

    // Bootstrap opacity utilities on text
    .opacity-50 {
        opacity: 0.7 !important;
    }

    .opacity-25 {
        opacity: 0.5 !important;
    }

    .border {
        border-color: var(--nova-border) !important;
    }

    .border-bottom {
        border-bottom-color: var(--nova-border) !important;
    }

    .border-top {
        border-top-color: var(--nova-border) !important;
    }

    .shadow-sm {
        box-shadow: var(--nova-shadow-sm) !important;
    }

    .shadow {
        box-shadow: var(--nova-shadow) !important;
    }

    .card {
        background-color: var(--nova-surface) !important;
        border-color: var(--nova-border) !important;
        color: var(--nova-text) !important;
    }

    .card-header, .card-footer {
        background-color: var(--nova-bg-alt) !important;
        border-color: var(--nova-border) !important;
    }

    .table {
        color: var(--nova-text) !important;
        border-color: var(--nova-border) !important;
        --bs-table-bg: transparent;
        --bs-table-striped-bg: var(--nova-bg-alt);
        --bs-table-hover-bg: var(--nova-accent-light);
    }

    .list-group-item {
        background-color: var(--nova-surface) !important;
        border-color: var(--nova-border) !important;
        color: var(--nova-text) !important;
    }

    .breadcrumb {
        background: transparent !important;
    }

    hr {
        border-color: var(--nova-border) !important;
    }

    // ─── Buttons ─────────────────────────────────────────────────────
    .btn-light {
        background-color: var(--nova-surface-raised) !important;
        border-color: var(--nova-border) !important;
        color: var(--nova-text) !important;

        &:hover, &:focus {
            background-color: var(--nova-bg-alt) !important;
            border-color: var(--nova-border) !important;
            color: var(--nova-text) !important;
        }
    }

    // Odoo btn-secondary: compiled with $o-btn-secondary-bg = white for both bg AND border
    .btn-secondary {
        background-color: var(--nova-surface-raised) !important;
        border-color: var(--nova-border) !important;
        color: var(--nova-text) !important;

        &:hover, &:focus, &:active, &.active, &.show {
            background-color: var(--nova-bg-alt) !important;
            border-color: var(--nova-border) !important;
            color: var(--nova-text) !important;
        }

        &:focus {
            box-shadow: 0 0 0 3px var(--nova-accent-light) !important;
        }
    }

    .btn-outline-secondary {
        border-color: var(--nova-border) !important;
        color: var(--nova-text-secondary) !important;

        &:hover, &:focus, &:active, &.active {
            background-color: var(--nova-surface-raised) !important;
            border-color: var(--nova-border) !important;
            color: var(--nova-text) !important;
        }
    }

    // Generic .btn — catch-all border fix for any button with white/light border
    .btn:not(.btn-primary):not(.btn-success):not(.btn-danger):not(.btn-warning):not(.btn-info):not(.btn-link) {
        border-color: var(--nova-border) !important;
    }

    // ─── Inputs ──────────────────────────────────────────────────────
    .form-control, .form-select,
    .o_input, input.o_input, textarea.o_input,
    select.o_input,
    .o_field_widget input,
    .o_field_widget textarea,
    .o_field_widget select {
        background-color: var(--nova-bg-alt) !important;
        border-color: var(--nova-border) !important;
        color: var(--nova-text) !important;

        &:focus {
            background-color: var(--nova-surface) !important;
            border-color: var(--nova-accent) !important;
            box-shadow: 0 0 0 3px var(--nova-accent-light) !important;
        }

        &:read-only, &[readonly], &:disabled {
            background-color: var(--nova-surface) !important;
            color: var(--nova-text-secondary) !important;
        }

        &::placeholder {
            color: var(--nova-text-tertiary) !important;
        }
    }

    .form-check-input {
        background-color: var(--nova-bg-alt) !important;
        border-color: var(--nova-border) !important;

        &:checked {
            background-color: var(--nova-accent) !important;
            border-color: var(--nova-accent) !important;
        }
    }

    // ─── Dropdowns ───────────────────────────────────────────────────
    .dropdown-menu {
        background: var(--nova-surface) !important;
        border-color: var(--nova-border) !important;
        color: var(--nova-text) !important;

        .dropdown-item {
            color: var(--nova-text) !important;

            &:hover, &:focus {
                background: var(--nova-accent-light) !important;
                color: var(--nova-accent) !important;
            }

            &.active, &.selected {
                background: var(--nova-accent-light) !important;
                color: var(--nova-accent) !important;
            }
        }

        .dropdown-divider {
            border-color: var(--nova-border) !important;
        }

        .dropdown-header {
            color: var(--nova-text-tertiary) !important;
        }
    }

    // ─── Modals ──────────────────────────────────────────────────────
    .modal {
        .modal-content {
            background: var(--nova-surface) !important;
            border-color: var(--nova-border) !important;
            color: var(--nova-text) !important;
        }

        .modal-header {
            border-bottom-color: var(--nova-border) !important;
            color: var(--nova-text) !important;
        }

        .modal-body {
            color: var(--nova-text) !important;
        }

        .modal-footer {
            background: var(--nova-bg-alt) !important;
            border-top-color: var(--nova-border) !important;
        }

        .btn-close {
            filter: invert(1);
        }
    }

    // ─── Tooltips & Popovers ─────────────────────────────────────────
    .tooltip .tooltip-inner {
        background: var(--nova-surface-raised) !important;
        color: var(--nova-text) !important;
    }

    .popover {
        background-color: var(--nova-surface) !important;
        border-color: var(--nova-border) !important;

        .popover-header {
            background-color: var(--nova-bg-alt) !important;
            border-bottom-color: var(--nova-border) !important;
            color: var(--nova-text) !important;
        }

        .popover-body {
            color: var(--nova-text) !important;
        }

        .popover-arrow::before {
            border-color: var(--nova-border) !important;
        }

        .popover-arrow::after {
            border-color: var(--nova-surface) !important;
        }
    }

    // ─── Nav tabs ────────────────────────────────────────────────────
    .nav-tabs {
        border-bottom-color: var(--nova-border) !important;

        .nav-link {
            color: var(--nova-text-secondary) !important;

            &:hover {
                border-color: transparent !important;
                color: var(--nova-text) !important;
            }

            &.active {
                background-color: transparent !important;
                border-color: transparent transparent var(--nova-accent) !important;
                color: var(--nova-accent) !important;
            }
        }
    }

    // ─── Pagination ──────────────────────────────────────────────────
    .page-item .page-link {
        background-color: var(--nova-surface) !important;
        border-color: var(--nova-border) !important;
        color: var(--nova-text) !important;
    }

    .page-item.active .page-link {
        background-color: var(--nova-accent) !important;
        border-color: var(--nova-accent) !important;
    }

    // ─── Progress ────────────────────────────────────────────────────
    .progress {
        background-color: var(--nova-bg-alt) !important;
    }

    // ─── Alerts ──────────────────────────────────────────────────────
    .alert {
        border-color: var(--nova-border) !important;
        color: var(--nova-text) !important;
    }

    // ═══════════════════════════════════════════════════════════════════
    // ODOO CONTROL PANEL
    // ═══════════════════════════════════════════════════════════════════

    .o_control_panel {
        background-color: var(--nova-surface) !important;
        border-bottom-color: var(--nova-border) !important;

        .breadcrumb-item {
            a {
                color: var(--nova-text-secondary) !important;
                &:hover {
                    color: var(--nova-accent) !important;
                }
            }
            &.active {
                color: var(--nova-text) !important;
            }
        }

        .o_cp_bottom {
            background-color: var(--nova-surface) !important;
        }
    }

    // ─── Searchview ──────────────────────────────────────────────────
    .o_searchview {
        background: var(--nova-bg-alt) !important;
        border-color: var(--nova-border) !important;

        .o_searchview_input {
            color: var(--nova-text) !important;

            &::placeholder {
                color: var(--nova-text-tertiary) !important;
            }
        }

        .o_searchview_facet {
            .o_searchview_facet_label {
                background: var(--nova-accent) !important;
                color: white !important;
            }

            .o_facet_values {
                border-color: var(--nova-accent) !important;
                background: var(--nova-accent-light) !important;
                color: var(--nova-accent) !important;
            }

            .o_facet_remove {
                color: var(--nova-accent) !important;
            }
        }
    }

    // ─── Search panel (left sidebar in views) ────────────────────────
    .o_search_panel {
        background-color: var(--nova-surface) !important;
        border-right-color: var(--nova-border) !important;

        .o_search_panel_category_value,
        .o_search_panel_filter_group {
            &:hover {
                background-color: var(--nova-accent-light) !important;
            }
        }

        .o_search_panel_label {
            color: var(--nova-text) !important;
        }

        .o_search_panel_group_header {
            color: var(--nova-text-secondary) !important;
        }
    }

    // ═══════════════════════════════════════════════════════════════════
    // FORM VIEW
    // ═══════════════════════════════════════════════════════════════════

    .o_form_view {
        background-color: var(--nova-bg) !important;

        .o_form_sheet_bg {
            background: var(--nova-bg) !important;
        }

        .o_form_sheet {
            background: var(--nova-surface) !important;
            border-color: var(--nova-border) !important;
        }

        .o_form_statusbar {
            background: var(--nova-bg-alt) !important;
            border-bottom-color: var(--nova-border) !important;

            .o_statusbar_status .o_arrow_button {
                background: transparent !important;
                border-color: var(--nova-border) !important;
                color: var(--nova-text-secondary) !important;

                &:hover {
                    background: var(--nova-accent-light) !important;
                    color: var(--nova-accent) !important;
                }

                &.o_arrow_button_current {
                    background: var(--nova-accent) !important;
                    border-color: var(--nova-accent) !important;
                    color: white !important;
                }
            }
        }

        .o_group .o_horizontal_separator {
            border-bottom-color: var(--nova-border) !important;
            color: var(--nova-text) !important;
        }

        label.o_form_label {
            color: var(--nova-text-secondary) !important;
        }

        .o_td_label label {
            color: var(--nova-text-secondary) !important;
        }

        .o_notebook .nav-tabs {
            border-bottom-color: var(--nova-border) !important;

            .nav-link {
                color: var(--nova-text-secondary) !important;

                &:hover {
                    color: var(--nova-text) !important;
                }

                &.active {
                    color: var(--nova-accent) !important;
                    border-bottom-color: var(--nova-accent) !important;
                    background: transparent !important;
                }
            }
        }

        .o_notebook .tab-content {
            background: transparent !important;
        }

        // Many2one fields
        .o_field_many2one_selection {
            background-color: var(--nova-bg-alt) !important;
            border-color: var(--nova-border) !important;

            input {
                background: transparent !important;
                color: var(--nova-text) !important;
            }
        }

        // Many2many tags
        .o_field_many2many_tags .badge {
            background-color: var(--nova-accent-light) !important;
            color: var(--nova-accent) !important;
            border-color: transparent !important;

            .o_delete {
                color: var(--nova-accent) !important;
            }
        }

        // Title field
        .oe_title input, .oe_title textarea {
            color: var(--nova-text) !important;
        }

        // Readonly fields with span display
        .o_field_widget .o_field_char,
        .o_field_widget .o_field_text,
        .o_field_widget span.o_readonly {
            color: var(--nova-text) !important;
        }

        // One2many / many2many list inside forms
        .o_field_one2many, .o_field_many2many {
            .o_list_view .o_list_table {
                background: var(--nova-surface) !important;

                thead th {
                    background: var(--nova-bg-alt) !important;
                    color: var(--nova-text-secondary) !important;
                    border-color: var(--nova-border) !important;
                }

                tbody td {
                    border-color: var(--nova-border) !important;
                    color: var(--nova-text) !important;
                }
            }
        }

        // Stat buttons
        .oe_stat_button {
            border-color: var(--nova-border) !important;
            color: var(--nova-text) !important;

            .o_stat_info .o_stat_text {
                color: var(--nova-text-secondary) !important;
            }

            .o_stat_info .o_stat_value {
                color: var(--nova-text) !important;
            }

            &:hover {
                background-color: var(--nova-accent-light) !important;
            }
        }

        // Inner groups
        .o_inner_group {
            .o_wrap_label label,
            .o_td_label label {
                color: var(--nova-text-secondary) !important;
            }
        }

        // Widget fields
        .o_field_widget {
            color: var(--nova-text) !important;
        }
    }

    // ═══════════════════════════════════════════════════════════════════
    // LIST VIEW
    // ═══════════════════════════════════════════════════════════════════

    .o_list_view {
        background-color: var(--nova-bg) !important;

        .o_list_table {
            background: var(--nova-surface) !important;
            border-color: var(--nova-border) !important;

            thead th {
                background: var(--nova-bg-alt) !important;
                border-color: var(--nova-border) !important;
                color: var(--nova-text-secondary) !important;
            }

            tbody td {
                border-color: var(--nova-border) !important;
                color: var(--nova-text) !important;
            }

            // Alternating row colors (Discord-style)
            tbody tr.o_data_row {
                td {
                    background-color: var(--nova-surface) !important;
                }

                &:nth-child(even) td {
                    background-color: var(--nova-bg-alt) !important;
                }

                &:hover td {
                    background-color: var(--nova-accent-light) !important;
                }
            }

            tbody tr {
                &.o_group_header {
                    background-color: var(--nova-bg-alt) !important;
                    color: var(--nova-text) !important;
                    border-color: var(--nova-border) !important;

                    td {
                        background-color: var(--nova-bg-alt) !important;
                    }
                }
            }

            tfoot td {
                background: var(--nova-bg-alt) !important;
                color: var(--nova-text) !important;
                border-color: var(--nova-border) !important;
            }
        }

        // Optional columns
        .o_optional_columns_dropdown .dropdown-menu {
            background: var(--nova-surface) !important;
        }
    }

    // ═══════════════════════════════════════════════════════════════════
    // KANBAN VIEW
    // ═══════════════════════════════════════════════════════════════════

    .o_kanban_view,
    .o_kanban_renderer {
        background-color: var(--nova-bg) !important;

        .o_kanban_group {
            background: var(--nova-bg-alt) !important;
            border-color: var(--nova-border-light) !important;

            // Folded column background
            &.o_column_folded {
                background-color: var(--nova-bg-alt) !important;
            }
        }

        .o_kanban_header {
            .o_kanban_header_title {
                color: var(--nova-text) !important;
            }

            .o_kanban_counter .o_kanban_counter_side {
                background: var(--nova-surface) !important;
                color: var(--nova-text-tertiary) !important;
            }
        }

        // CRITICAL: Odoo sets background on .o_kanban_record > div, NOT on .o_kanban_record
        // See kanban_controller.scss: ".o_kanban_record > div { background-color: $o-view-background-color }"
        .o_kanban_record > div {
            background-color: var(--nova-surface) !important;
            border-color: var(--nova-border) !important;
            color: var(--nova-text) !important;
        }

        .o_kanban_record {
            color: var(--nova-text) !important;

            &:hover > div {
                border-color: var(--nova-accent) !important;
            }

            // Force ALL text inside kanban cards to be readable in dark mode.
            // Odoo kanban QWeb templates use inline styles, random classes, etc.
            // This wildcard overrides everything.
            > div {
                *:not(.badge):not([class*="text-bg-"]) {
                    color: var(--nova-text) !important;
                }
                small, .text-muted, .text-600 {
                    color: var(--nova-text-tertiary) !important;
                }
                .text-danger { color: var(--nova-danger) !important; }
                .text-success { color: var(--nova-success) !important; }
                .text-warning { color: var(--nova-warning) !important; }
                .text-info { color: var(--nova-info) !important; }
                .text-primary { color: var(--nova-accent) !important; }
            }

            .o_kanban_record_title,
            .o_kanban_record_headings,
            .o_text_overflow {
                color: var(--nova-text) !important;
            }

            .o_kanban_record_subtitle,
            .o_kanban_record_body {
                color: var(--nova-text-secondary) !important;
            }

            .oe_kanban_details {
                color: var(--nova-text) !important;
            }

            // Project kanban
            .o_project_kanban_main {
                color: var(--nova-text) !important;
            }
            .o_kanban_manage_button_section,
            .o_kanban_card_manage_section {
                color: var(--nova-text) !important;
            }

            // Links
            a:not(.dropdown-item) {
                color: var(--nova-accent) !important;
            }

            // Dropdown menu button (three dots)
            .o_dropdown_kanban .dropdown-toggle {
                color: var(--nova-text-secondary) !important;
            }

            .o_kanban_record_bottom {
                border-top-color: var(--nova-border-light) !important;
            }

            // Badges
            .badge {
                color: var(--nova-text) !important;
            }
            .badge.text-bg-secondary,
            .badge.bg-secondary {
                background-color: var(--nova-surface-raised) !important;
                color: var(--nova-text-secondary) !important;
            }
            .badge.text-bg-success,
            .badge.bg-success {
                background-color: var(--nova-success-light) !important;
                color: var(--nova-success) !important;
            }
            .badge.text-bg-warning,
            .badge.bg-warning {
                background-color: var(--nova-warning-light) !important;
                color: var(--nova-warning) !important;
            }
            .badge.text-bg-danger,
            .badge.bg-danger {
                background-color: var(--nova-danger-light) !important;
                color: var(--nova-danger) !important;
            }
            .badge.text-bg-info,
            .badge.bg-info {
                background-color: var(--nova-info-light) !important;
                color: var(--nova-info) !important;
            }
            .badge.text-bg-primary,
            .badge.bg-primary {
                background-color: var(--nova-accent-light) !important;
                color: var(--nova-accent) !important;
            }
            .badge.text-bg-light,
            .badge.bg-light {
                background-color: var(--nova-surface-raised) !important;
                color: var(--nova-text) !important;
            }

            // Tags
            .o_field_many2manytags .o_tag {
                color: var(--nova-text) !important;
            }

            // Field widgets inside kanban cards
            .o_field_widget {
                color: var(--nova-text) !important;
            }

            // Priority stars
            .o_priority .fa-star-o {
                color: var(--nova-text-tertiary) !important;
            }
            .o_priority .fa-star {
                color: var(--nova-warning) !important;
            }

            // Activity icons
            .o_kanban_activity_status {
                &.text-success { color: var(--nova-success) !important; }
                &.text-warning { color: var(--nova-warning) !important; }
                &.text-danger { color: var(--nova-danger) !important; }
            }
        }

        // Kanban card manage dropdown (column settings, etc.)
        .o_kanban_manage_toggle_button {
            color: var(--nova-text-secondary) !important;
        }

        // Column progressbar
        .o_kanban_counter_progress {
            .progress {
                background-color: var(--nova-bg-alt) !important;
            }
        }

        // Kanban column header + and count text
        .o_kanban_header .o_column_title {
            color: var(--nova-text) !important;
        }
        .o_kanban_load_more {
            color: var(--nova-accent) !important;
        }

        .o_kanban_quick_create {
            background-color: var(--nova-surface) !important;
            border-color: var(--nova-border) !important;

            input {
                background: var(--nova-bg-alt) !important;
                color: var(--nova-text) !important;
            }
        }

        // Ungrouped kanban — inner div also needs override
        &.o_kanban_ungrouped .o_kanban_record > div {
            background-color: var(--nova-surface) !important;
        }

        // Ghost cards
        .o_kanban_record.o_kanban_ghost > div {
            background: transparent !important;
            border: none !important;
        }

        // Progressbar
        .o_kanban_counter_progress .progress {
            background-color: var(--nova-bg-alt) !important;
        }

        // Column highlight when dragging
        .o_kanban_group.o_kanban_hover {
            background-color: var(--nova-accent-light) !important;
        }

        // Kanban CSS custom properties
        --KanbanGroup-grouped-bg: var(--nova-bg-alt);
        --KanbanColumn__highlight-background: var(--nova-accent-light);
    }

    // ═══════════════════════════════════════════════════════════════════
    // CALENDAR VIEW
    // ═══════════════════════════════════════════════════════════════════

    .o_calendar_view {
        background-color: var(--nova-bg) !important;

        .o_calendar_renderer {
            background-color: var(--nova-bg) !important;
            background: var(--nova-bg) !important;
        }

        .o_calendar_sidebar_container {
            background-color: var(--nova-surface) !important;
            border-left-color: var(--nova-border) !important;
        }

        .o_calendar_widget {
            background: var(--nova-surface) !important;
            border-color: var(--nova-border) !important;
        }

        // Sidebar calendar (mini datepicker + participants + filters)
        .o_calendar_sidebar {
            background: var(--nova-surface) !important;
            color: var(--nova-text) !important;

            // ALL text inside the sidebar — covers "Participants", "Synchroniser avec:", etc.
            label,
            span,
            p,
            h1, h2, h3, h4, h5, h6,
            .o_calendar_filter_item,
            .o_cw_filter_label,
            .o_calendar_filter_items_checkall,
            .form-check-label {
                color: var(--nova-text-secondary) !important;
            }

            // Section titles in sidebar
            .o_calendar_filter > h5,
            .o_calendar_filter > .small,
            .o_calendar_filter_title,
            b, strong {
                color: var(--nova-text) !important;
            }

            .o_calendar_mini {
                background: var(--nova-surface) !important;

                th { color: var(--nova-text-secondary) !important; }
                td {
                    color: var(--nova-text) !important;
                    &.fc-day-other { color: var(--nova-text-tertiary) !important; }
                }
                .fc-day-today {
                    background: var(--nova-accent) !important;
                    border-radius: var(--nova-radius-full);
                    color: white !important;
                }
            }

            // Mini calendar buttons
            .fc-button {
                background: transparent !important;
                color: var(--nova-text-secondary) !important;
                border-color: var(--nova-border) !important;
            }

            // Checkboxes
            .form-check-input {
                background-color: var(--nova-surface-raised) !important;
                border-color: var(--nova-border) !important;
            }
        }

        // ─── FullCalendar — aggressive dark mode ──────────────────────────
        .fc {
            // FullCalendar CSS custom properties
            --fc-page-bg-color: var(--nova-surface);
            --fc-neutral-bg-color: var(--nova-bg-alt);
            --fc-border-color: var(--nova-border);
            --fc-today-bg-color: var(--nova-accent-light);
            --fc-now-indicator-color: var(--nova-danger);
            --fc-event-bg-color: var(--nova-accent);
            --fc-event-border-color: var(--nova-accent);
            --fc-list-event-hover-bg-color: var(--nova-accent-light);

            background: var(--nova-surface) !important;

            // Nuclear option: force ALL td/th/table backgrounds inside FC
            table {
                background: var(--nova-surface) !important;
            }
            td, th {
                border-color: var(--nova-border) !important;
                background-color: var(--nova-surface) !important;
            }

            // View harness
            .fc-view-harness,
            .fc-view {
                background: var(--nova-surface) !important;
            }

            .fc-col-header-cell {
                background: var(--nova-bg-alt) !important;
                border-color: var(--nova-border) !important;
                a { color: var(--nova-text-secondary) !important; }
            }

            // Day cells (month view)
            .fc-daygrid-day {
                background: var(--nova-surface) !important;

                &.fc-day-today {
                    background: var(--nova-accent-light) !important;
                }
                &.fc-day-other {
                    background: var(--nova-bg-alt) !important;
                }
                .fc-daygrid-day-number {
                    color: var(--nova-text) !important;
                }
                .fc-daygrid-day-top {
                    color: var(--nova-text) !important;
                }
            }

            // Time grid cells (week/day view)
            .fc-timegrid-col {
                background: var(--nova-surface) !important;
            }
            .fc-timegrid-slot {
                background: var(--nova-surface) !important;
                border-color: var(--nova-border) !important;
            }
            .fc-timegrid-slot-lane {
                background: var(--nova-surface) !important;
            }
            .fc-timegrid-col.fc-day-today {
                background: var(--nova-accent-light) !important;
            }

            // Time labels
            .fc-timegrid-slot-label {
                color: var(--nova-text-tertiary) !important;
                background: var(--nova-surface) !important;
            }
            .fc-timegrid-axis {
                background: var(--nova-surface) !important;
            }

            // Scrollgrid and table structure
            .fc-scrollgrid {
                border-color: var(--nova-border) !important;
            }
            .fc-scrollgrid-section > td {
                border-color: var(--nova-border) !important;
            }

            // Events
            .fc-event {
                border-radius: var(--nova-radius-sm);
            }

            // List view inside calendar
            .fc-list {
                background: var(--nova-surface) !important;

                .fc-list-day-cushion {
                    background: var(--nova-bg-alt) !important;
                    color: var(--nova-text) !important;
                }
                .fc-list-event td {
                    background: var(--nova-surface) !important;
                    color: var(--nova-text) !important;
                }
            }

            .fc-toolbar {
                .fc-button {
                    background: var(--nova-surface-raised) !important;
                    border-color: var(--nova-border) !important;
                    color: var(--nova-text) !important;

                    &:hover {
                        background: var(--nova-accent-light) !important;
                    }

                    &.fc-button-active {
                        background: var(--nova-accent) !important;
                        color: white !important;
                    }
                }

                .fc-toolbar-title {
                    color: var(--nova-text) !important;
                }
            }
        }
    }

    // ═══════════════════════════════════════════════════════════════════
    // PIVOT & GRAPH
    // ═══════════════════════════════════════════════════════════════════

    .o_pivot {
        background: var(--nova-surface) !important;

        table {
            color: var(--nova-text) !important;

            th {
                background: var(--nova-bg-alt) !important;
                color: var(--nova-text-secondary) !important;
                border-color: var(--nova-border) !important;
            }

            td {
                border-color: var(--nova-border-light) !important;
            }
        }
    }

    // Graph view — canvas has white background by default
    .o_graph_renderer {
        background: var(--nova-surface) !important;

        canvas {
            background-color: transparent !important;
        }
    }

    // ═══════════════════════════════════════════════════════════════════
    // CHATTER
    // ═══════════════════════════════════════════════════════════════════

    // Chatter container aside — left border fix
    .o_FormRenderer_chatterContainer.o-aside {
        border-left-color: var(--nova-border) !important;
    }

    .o_FormRenderer_chatterContainer.o-isInFormSheetBg {
        background-color: var(--nova-bg) !important;
        border-top-color: var(--nova-border) !important;
    }

    .o_Chatter, .o_ChatterContainer {
        border-top-color: var(--nova-border) !important;
        background: var(--nova-bg) !important;
    }

    .o_Message {
        border-bottom-color: var(--nova-border-light) !important;
        color: var(--nova-text) !important;

        // Author name
        .o_Message_authorName {
            color: var(--nova-text) !important;
        }

        // Timestamp ("il y a 2 mois")
        .o_Message_date {
            color: var(--nova-text-tertiary) !important;
            opacity: 0.8 !important;
        }

        // Message content
        .o_Message_content,
        .o_Message_prettyBody {
            color: var(--nova-text) !important;
        }

        // Message bubble backgrounds
        .o_Message_background {
            border-color: var(--nova-border) !important;

            &.o-isAuthorNotCurrentUserOrGuest {
                background-color: var(--nova-accent-light) !important;
                border-color: var(--nova-accent) !important;
            }
        }

        // Tracking values (field change logs)
        .o_Message_trackingValues li,
        .o_Message_trackingValue {
            color: var(--nova-text-secondary) !important;
        }
    }

    // Message list & thread view backgrounds
    .o_MessageList {
        background: var(--nova-bg) !important;
    }

    .o_ThreadView {
        background: var(--nova-bg) !important;
    }

    // bg-view and bg-100 used in chatter
    .bg-view {
        background-color: var(--nova-bg) !important;
    }

    .bg-100 {
        background-color: var(--nova-bg) !important;
    }

    // Date separators ("16 décembre 2025")
    .o_MessageList_separatorLabel {
        color: var(--nova-text-secondary) !important;
    }

    .o_MessageList_separatorLine {
        border-color: var(--nova-border) !important;
    }

    // Activity summary and info text
    .o_Activity {
        .o_Activity_summary {
            color: var(--nova-text) !important;
        }

        .o_Activity_dueDateText {
            b, strong {
                opacity: 1 !important;
            }
        }

        .o_Activity_userName,
        .o_Activity_info {
            color: var(--nova-text-secondary) !important;
        }

        .o_Activity_note {
            color: var(--nova-text-secondary) !important;
        }
    }

    // Activity box title
    .o_ActivityBox_titleText {
        color: var(--nova-text-secondary) !important;
    }

    .o_ActivityBox_titleLine {
        border-color: var(--nova-border) !important;
    }

    .o_Composer {
        background: var(--nova-surface) !important;
        border-color: var(--nova-border) !important;

        .o_Composer_input, textarea {
            background: var(--nova-bg-alt) !important;
            color: var(--nova-text) !important;
            border-color: var(--nova-border) !important;
        }
    }

    .o_attachment_card {
        background: var(--nova-surface-raised) !important;
        border-color: var(--nova-border) !important;
    }

    // ═══════════════════════════════════════════════════════════════════
    // APP LAUNCHER
    // ═══════════════════════════════════════════════════════════════════

    .nova-app-launcher-overlay {
        background: var(--nova-bg) !important;
    }

    .nova-launcher-search__input {
        background: var(--nova-surface) !important;
        border-color: var(--nova-border) !important;
        color: var(--nova-text) !important;
    }

    .nova-app-tile__label {
        color: var(--nova-text-secondary) !important;
    }

    // ═══════════════════════════════════════════════════════════════════
    // NOTIFICATIONS & TOASTS
    // ═══════════════════════════════════════════════════════════════════

    .o_notification {
        background: var(--nova-surface) !important;
        border-color: var(--nova-border) !important;
        color: var(--nova-text) !important;
    }

    // ═══════════════════════════════════════════════════════════════════
    // SETTINGS
    // ═══════════════════════════════════════════════════════════════════

    .o_base_settings {
        // Override Odoo CSS custom properties for settings
        --settings__tab-bg: var(--nova-surface);
        --settings__tab-bg--active: var(--nova-accent-light);
        --settings__tab-color: var(--nova-text-secondary);
        --settings__title-bg: var(--nova-bg-alt);

        background: var(--nova-bg) !important;

        .o_setting_container .settings {
            background-color: var(--nova-bg) !important;
        }

        .o_setting_container .settings_tab {
            background: var(--nova-surface) !important;

            .tab {
                color: var(--nova-text-secondary) !important;

                &:hover, &.selected {
                    color: var(--nova-text) !important;
                }
            }

            .selected {
                background-color: var(--nova-accent-light) !important;
                box-shadow: inset 2px 0 0 var(--nova-accent) !important;
            }
        }

        .app_settings_block h2 {
            background-color: var(--nova-bg-alt) !important;
            color: var(--nova-text) !important;
        }

        .o_setting_box {
            color: var(--nova-text) !important;
        }

        .o_setting_right_pane {
            border-left-color: var(--nova-border) !important;
            color: var(--nova-text) !important;
        }

        .app_settings_header {
            background: var(--nova-surface) !important;
            border-bottom-color: var(--nova-border) !important;
        }

        .o_settings_container {
            background: var(--nova-bg) !important;
        }

        .settingSearchHeader {
            background-color: var(--nova-bg-alt) !important;
            color: var(--nova-text) !important;
        }
    }

    // ═══════════════════════════════════════════════════════════════════
    // AUTOCOMPLETE & SPECIAL WIDGETS
    // ═══════════════════════════════════════════════════════════════════

    .ui-autocomplete {
        background-color: var(--nova-surface) !important;
        border-color: var(--nova-border) !important;

        .ui-menu-item {
            color: var(--nova-text) !important;

            &:hover,
            &.ui-state-active,
            &.ui-state-focus {
                background-color: var(--nova-accent-light) !important;
                color: var(--nova-accent) !important;
            }
        }
    }

    // Odoo autocomplete dropdown
    .o-autocomplete--dropdown-menu {
        background-color: var(--nova-surface) !important;
        border-color: var(--nova-border) !important;

        .o-autocomplete--dropdown-item {
            color: var(--nova-text) !important;

            &:hover, &:focus {
                background-color: var(--nova-accent-light) !important;
            }
        }
    }

    // ═══════════════════════════════════════════════════════════════════
    // MISCELLANEOUS ODOO ELEMENTS
    // ═══════════════════════════════════════════════════════════════════

    // Activity view
    .o_activity_view {
        .table {
            th, td {
                background: var(--nova-surface) !important;
                border-color: var(--nova-border) !important;
            }
        }
    }

    // Loading / progress
    .o_loading {
        background-color: var(--nova-accent) !important;
    }

    // Discuss / messaging
    .o_mail_discuss_sidebar {
        background: var(--nova-surface) !important;
        border-right-color: var(--nova-border) !important;
    }

    // Tree indentation backgrounds
    .o_group_name {
        color: var(--nova-text) !important;
    }

    // Status widget colors
    .o_field_badge .badge {
        &.text-bg-success, &.bg-success-light {
            background-color: var(--nova-success-light) !important;
            color: var(--nova-success) !important;
        }
        &.text-bg-warning, &.bg-warning-light {
            background-color: var(--nova-warning-light) !important;
            color: var(--nova-warning) !important;
        }
        &.text-bg-danger, &.bg-danger-light {
            background-color: var(--nova-danger-light) !important;
            color: var(--nova-danger) !important;
        }
        &.text-bg-info, &.bg-info-light {
            background-color: var(--nova-info-light) !important;
            color: var(--nova-info) !important;
        }
    }

    // Chatter topbar / mail thread buttons
    .o_ChatterTopbar {
        background: var(--nova-surface) !important;
        border-bottom-color: var(--nova-border) !important;

        .btn {
            color: var(--nova-text-secondary) !important;
            border-color: var(--nova-border) !important;

            &:hover {
                background: var(--nova-accent-light) !important;
                color: var(--nova-accent) !important;
            }
        }
    }

    // Follow button
    .o_FollowButton {
        .o_FollowButton_follow {
            background: var(--nova-surface) !important;
            border-color: var(--nova-border) !important;
            color: var(--nova-text-secondary) !important;

            &:hover {
                background: var(--nova-accent-light) !important;
                color: var(--nova-accent) !important;
            }
        }

        .o_FollowButton_unfollow {
            background: var(--nova-surface) !important;
            border-color: var(--nova-border) !important;
        }
    }

    // Follower list button
    .o_FollowerListMenu_buttonFollowers {
        background: var(--nova-surface) !important;
        border-color: var(--nova-border) !important;
        color: var(--nova-text-secondary) !important;
    }

    // Activity tools in dark mode
    .o_Activity_tools {
        .o_Activity_markDoneButton.btn {
            color: var(--nova-success) !important;
            background: var(--nova-success-light) !important;

            &:hover, &:focus, &:active {
                background: var(--nova-success) !important;
                color: var(--nova-bg) !important;
            }
        }

        .o_Activity_editButton.btn {
            color: var(--nova-accent) !important;
            background: var(--nova-accent-light) !important;

            &:hover, &:focus, &:active {
                background: var(--nova-accent) !important;
                color: var(--nova-bg) !important;
            }
        }

        .o_Activity_cancelButton.btn {
            color: var(--nova-text-tertiary) !important;
            border-color: var(--nova-border) !important;
            background: transparent !important;

            &:hover, &:focus, &:active {
                background: var(--nova-danger-light) !important;
                color: var(--nova-danger) !important;
            }
        }

        .o_Activity_uploadButton.btn {
            color: var(--nova-info) !important;
            background: var(--nova-info-light) !important;

            &:hover, &:focus, &:active {
                background: var(--nova-info) !important;
                color: var(--nova-bg) !important;
            }
        }
    }

    // Attachment buttons in chatter
    .o_ChatterTopbar_buttonToggleAttachments,
    .o_ChatterTopbar_buttonAddAttachments {
        background: var(--nova-surface) !important;
        border-color: var(--nova-border) !important;
        color: var(--nova-text-secondary) !important;
    }

    // Extra: any remaining white backgrounds from Odoo
    .o_field_widget .o_external_button {
        color: var(--nova-text-secondary) !important;
    }

    .o_field_widget .o_input_dropdown {
        background: var(--nova-bg-alt) !important;
    }

    // Web studio, debug mode elements
    .o_debug_manager .dropdown-menu {
        background: var(--nova-surface) !important;
    }

    // Gantt, pivot header backgrounds
    .o_view_controller {
        background-color: var(--nova-bg) !important;
    }

    // ═══════════════════════════════════════════════════════════════════
    // ADDITIONAL DARK MODE OVERRIDES
    // ═══════════════════════════════════════════════════════════════════

    // Kanban ghost cards — hide completely
    .o_kanban_view .o_kanban_record.o_kanban_ghost,
    .o_kanban_renderer .o_kanban_record.o_kanban_ghost {
        > div {
            background: transparent !important;
            border: none !important;
        }
    }

    // Kanban examples / ghost views
    .o_kanban_examples_ghostview,
    .o_kanban_example_ghost_card {
        background: var(--nova-bg-alt) !important;
        border-color: var(--nova-border) !important;
        opacity: 0.5;
    }

    // Any remaining white bg utility classes
    .bg-view {
        background-color: var(--nova-bg) !important;
    }

    // No-content empty state — Odoo compiles a white radial-gradient from $o-view-background-color
    .o_view_nocontent {
        background: var(--nova-bg) !important;
        background-image: none !important;

        .o_nocontent_help {
            color: var(--nova-text-secondary) !important;

            > p:first-of-type {
                color: var(--nova-text) !important;
            }

            // Smiley face SVG — invert for dark mode
            .o_view_nocontent_smiling_face::before,
            .o_view_nocontent_neutral_face::before,
            .o_view_nocontent_empty_folder::before {
                filter: invert(0.8) hue-rotate(180deg);
                opacity: 0.6;
            }
        }
    }

    // Sample data empty state — Odoo sets white bg + huge white box-shadow glow
    .o_view_sample_data .o_nocontent_help {
        background-color: var(--nova-surface) !important;
        box-shadow: 0 0 120px 100px var(--nova-bg) !important;
    }

    // btn-primary white border — Odoo sets border: 1.5px solid #fff on CP primary buttons
    .o_cp_buttons .btn.btn-primary {
        border-color: var(--nova-accent) !important;
    }

    // Settings page — left sidebar
    .o_base_settings .o_base_settings_tabs {
        background: var(--nova-surface) !important;
        border-right-color: var(--nova-border) !important;

        .nav-link {
            color: var(--nova-text-secondary) !important;

            &:hover {
                background: var(--nova-accent-light) !important;
                color: var(--nova-text) !important;
            }

            &.active {
                background: var(--nova-accent-light) !important;
                color: var(--nova-accent) !important;
            }
        }
    }

    // Settings description text
    .o_base_settings .o_setting_left_pane,
    .o_base_settings .o_setting_right_pane {
        color: var(--nova-text) !important;

        .text-muted, small {
            color: var(--nova-text-tertiary) !important;
        }
    }

    // General "white" backgrounds used by Odoo
    .o_form_view .o_form_sheet_bg .o_form_sheet,
    .o_form_sheet {
        background: var(--nova-surface) !important;
        border-color: var(--nova-border) !important;
        color: var(--nova-text) !important;
    }

    // Input group addons
    .input-group-text {
        background-color: var(--nova-bg-alt) !important;
        border-color: var(--nova-border) !important;
        color: var(--nova-text-secondary) !important;
    }

    // Selection widgets
    .o_field_selection select,
    .o_field_selection_badge .o_selection_badge {
        background-color: var(--nova-bg-alt) !important;
        border-color: var(--nova-border) !important;
        color: var(--nova-text) !important;

        &.active, &.selected {
            background-color: var(--nova-accent-light) !important;
            color: var(--nova-accent) !important;
        }
    }

    // Status bar buttons text
    .o_form_statusbar .btn {
        color: var(--nova-text) !important;
    }

    // Record title — dark text on dark bg fix
    .o_form_view .oe_title input,
    .o_form_view .oe_title textarea,
    .o_form_view .oe_title span {
        color: var(--nova-text) !important;
    }

    // Stat buttons
    .o_form_view .oe_button_box .oe_stat_button {
        border-color: var(--nova-border) !important;
        color: var(--nova-text) !important;
        background: transparent !important;

        &:hover {
            background-color: var(--nova-accent-light) !important;
        }

        .o_button_icon {
            color: var(--nova-text-secondary) !important;
        }

        .o_stat_info {
            .o_stat_value {
                color: var(--nova-text) !important;
            }
            .o_stat_text {
                color: var(--nova-text-secondary) !important;
            }
        }
    }

    // Breadcrumb items
    .breadcrumb-item + .breadcrumb-item::before {
        color: var(--nova-text-tertiary) !important;
    }

    // CP buttons
    .o_control_panel .btn-secondary,
    .o_control_panel .btn-light {
        background-color: var(--nova-surface-raised) !important;
        border-color: var(--nova-border) !important;
        color: var(--nova-text) !important;
    }

    // CP switch view buttons
    .o_cp_switch_buttons .btn {
        color: var(--nova-text-secondary) !important;
        background: transparent !important;

        &.active {
            color: var(--nova-accent) !important;
        }

        &:hover {
            color: var(--nova-text) !important;
        }
    }

    // Many2one external link button
    .o_field_many2one .o_external_button {
        color: var(--nova-text-tertiary) !important;

        &:hover {
            color: var(--nova-accent) !important;
        }
    }

    // Tags field inside form
    .o_field_many2many_tags .badge {
        background-color: var(--nova-accent-light) !important;
        color: var(--nova-accent) !important;
    }

    // Notebook / tab pane bg
    .tab-content, .tab-pane {
        background: transparent !important;
        color: var(--nova-text) !important;
    }

    // Dialog / wizard
    .o_dialog .modal-content {
        background: var(--nova-surface) !important;
        color: var(--nova-text) !important;
    }

    // O_form_uri links
    .o_form_uri, a.o_form_uri {
        color: var(--nova-accent) !important;
    }

    // Pager
    .o_pager .o_pager_counter {
        color: var(--nova-text-secondary) !important;
    }

    .o_pager button {
        color: var(--nova-text-secondary) !important;
        background: transparent !important;
        border-color: var(--nova-border) !important;

        &:hover {
            color: var(--nova-accent) !important;
        }
    }

    // Buttons inside action manager
    .o_action_manager .btn-link {
        color: var(--nova-accent) !important;
    }

    // White text labels on white BG fix
    .o_wrap_field label,
    .o_cell label,
    .o_wrap_label label {
        color: var(--nova-text-secondary) !important;
    }

    // X2many list inside forms — full dark override
    .o_field_one2many,
    .o_field_many2many {
        .o_list_view {
            background-color: transparent !important;

            .o_list_table {
                background: var(--nova-surface) !important;
                border-color: var(--nova-border) !important;
                color: var(--nova-text) !important;

                thead th {
                    background: var(--nova-bg-alt) !important;
                    color: var(--nova-text-secondary) !important;
                    border-color: var(--nova-border) !important;
                }

                tbody td {
                    background: var(--nova-surface) !important;
                    color: var(--nova-text) !important;
                    border-color: var(--nova-border-light) !important;
                }

                tbody tr:hover td {
                    background: var(--nova-accent-light) !important;
                }

                tfoot td {
                    background: var(--nova-bg-alt) !important;
                    color: var(--nova-text) !important;
                    border-color: var(--nova-border) !important;
                }
            }
        }

        // "Ajouter une ligne" link
        .o_field_x2many_list_row_add a {
            color: var(--nova-accent) !important;
        }
    }

    // Inline editable x2many (open record in form)
    .o_field_one2many .o_form_view,
    .o_field_many2many .o_form_view {
        background: var(--nova-surface) !important;
    }

    // Tables inside form sheets (generic)
    .o_form_sheet table,
    .o_form_sheet .table {
        color: var(--nova-text) !important;
        border-color: var(--nova-border) !important;

        th {
            background: var(--nova-bg-alt) !important;
            color: var(--nova-text-secondary) !important;
            border-color: var(--nova-border) !important;
        }

        td {
            background: var(--nova-surface) !important;
            color: var(--nova-text) !important;
            border-color: var(--nova-border-light) !important;
        }
    }

    // Web Studio
    .o_web_studio_sidebar,
    .o_web_studio_view_renderer {
        background-color: var(--nova-bg) !important;
        color: var(--nova-text) !important;
    }

    // Dark mode close button on app launcher
    .nova-launcher-close {
        background: var(--nova-surface) !important;
        border-color: var(--nova-border) !important;
        color: var(--nova-text-secondary) !important;

        &:hover {
            background: var(--nova-danger-light) !important;
            color: var(--nova-danger) !important;
            border-color: var(--nova-danger) !important;
        }
    }

    // Catch-all for common Odoo BG patterns
    .o_kanban_group .o_column_quick_create,
    .o_kanban_group .o_column_quick_create input {
        background: var(--nova-bg-alt) !important;
        border-color: var(--nova-border) !important;
        color: var(--nova-text) !important;
    }

    // Quick create button in kanban column
    .o_kanban_quick_add {
        color: var(--nova-text-tertiary) !important;

        &:hover {
            color: var(--nova-accent) !important;
        }
    }

    // Kanban column quick create
    .o_column_quick_create {
        background: transparent !important;

        .o_quick_create_folded {
            background: var(--nova-bg-alt) !important;
            border-color: var(--nova-border) !important;
            color: var(--nova-text-secondary) !important;

            &:hover {
                background: var(--nova-accent-light) !important;
                color: var(--nova-accent) !important;
            }
        }

        .o_quick_create_unfolded {
            background: var(--nova-surface) !important;
            border-color: var(--nova-border) !important;

            input {
                background: var(--nova-bg-alt) !important;
                color: var(--nova-text) !important;
                border-color: var(--nova-border) !important;
            }
        }
    }

    // Remaining images filter
    img.oe_kanban_avatar {
        border-color: var(--nova-border) !important;
    }

    // Widget badges
    .badge.text-bg-light,
    .badge.bg-light {
        background-color: var(--nova-surface-raised) !important;
        color: var(--nova-text) !important;
    }

    .badge.text-bg-secondary,
    .badge.bg-secondary {
        background-color: var(--nova-surface-raised) !important;
        color: var(--nova-text-secondary) !important;
    }

    // No content message
    .o_nocontent_help {
        color: var(--nova-text-tertiary) !important;

        p {
            color: var(--nova-text-secondary) !important;
        }
    }

    // Action button links
    .o_form_view .o_group a,
    .o_form_view .o_inner_group a {
        color: var(--nova-accent) !important;
    }

    // ═══════════════════════════════════════════════════════════════════
    // NOTEBOOK TABS (source of white bg + white borders)
    // Odoo uses $o-view-background-color: white compiled in
    // core/notebook/notebook.scss and form_controller.scss
    // ═══════════════════════════════════════════════════════════════════

    .o_notebook {
        // Tab bar background (notebook.scss:22)
        .nav {
            background-color: var(--nova-surface) !important;
        }

        // Active tab — Odoo uses white bottom border to merge tab with pane
        .nav-link.active {
            border-bottom-color: var(--nova-surface) !important;
            border-color: var(--nova-border) !important;
            border-bottom-color: var(--nova-surface) !important;
            background-color: var(--nova-surface) !important;
            color: var(--nova-accent) !important;
        }

        .nav-link:not(.active) {
            color: var(--nova-text-secondary) !important;
        }

        // Tab content pane (form_controller.scss:535)
        > .tab-content {
            border-bottom-color: var(--nova-border) !important;
            border-color: var(--nova-border) !important;

            > .tab-pane {
                background-color: var(--nova-surface) !important;
                border-color: var(--nova-border) !important;
            }
        }

        // Notebook CSS custom properties
        --notebook-link-border-color-active: var(--nova-border);
        --notebook-link-border-color-active-accent: var(--nova-border);
    }

    // ═══════════════════════════════════════════════════════════════════
    // LIST TABLES (list_renderer.scss uses $o-view-background-color)
    // ═══════════════════════════════════════════════════════════════════

    // The o_list_renderer container itself has background-color: white
    .o_list_renderer {
        background-color: var(--nova-surface) !important;

        --ListRenderer-thead-bg-color: var(--nova-bg-alt);
        --ListRenderer-thead-border-end-color: var(--nova-border);
    }

    .o_list_renderer .o_list_table,
    .o_list_table {
        background-color: var(--nova-surface) !important;
        border-color: var(--nova-border) !important;
    }

    .o_list_renderer thead,
    .o_list_table thead {
        background-color: var(--nova-bg-alt) !important;

        th {
            background-color: var(--nova-bg-alt) !important;
            border-color: var(--nova-border) !important;
            color: var(--nova-text-secondary) !important;
        }
    }

    .o_list_renderer tbody td,
    .o_list_table tbody td {
        border-color: var(--nova-border) !important;
        color: var(--nova-text) !important;
    }

    // Alternating row colors for list renderer
    .o_list_renderer tbody tr.o_data_row,
    .o_list_table tbody tr.o_data_row {
        td {
            background-color: var(--nova-surface) !important;
        }
        &:nth-child(even) td {
            background-color: var(--nova-bg-alt) !important;
        }
        &:hover td {
            background-color: var(--nova-accent-light) !important;
        }
    }

    .o_list_renderer tfoot td,
    .o_list_table tfoot td {
        background-color: var(--nova-bg-alt) !important;
        border-color: var(--nova-border) !important;
        color: var(--nova-text) !important;
    }

    // Selected row in list
    .o_list_renderer .o_selected_row td,
    .o_list_renderer .o_selected_row th {
        background-color: var(--nova-surface) !important;
    }

    // x2many field wrappers inside forms
    .o_field_one2many,
    .o_field_many2many {
        background-color: transparent !important;

        .o_list_renderer {
            background-color: var(--nova-surface) !important;
        }

        .o_list_table {
            background-color: var(--nova-surface) !important;
        }

        .o_field_x2many_list_row_add a {
            color: var(--nova-accent) !important;
        }
    }

    // ═══════════════════════════════════════════════════════════════════
    // FORM VIEW (form_controller.scss uses $o-view-background-color)
    // ═══════════════════════════════════════════════════════════════════

    .o_form_view {
        background-color: var(--nova-bg) !important;

        .o_form_sheet_bg {
            background-color: var(--nova-bg) !important;
            border-bottom-color: var(--nova-border) !important;
            border-color: var(--nova-border) !important;
        }

        .o_form_sheet {
            background-color: var(--nova-surface) !important;
            border-color: var(--nova-border) !important;
            box-shadow: none !important;
            color: var(--nova-text) !important;
        }

        .o_group {
            border-color: var(--nova-border) !important;
        }

        .o_inner_group > tbody > tr > td {
            border-color: var(--nova-border-light) !important;
        }

        .o_horizontal_separator {
            border-color: var(--nova-border) !important;
            color: var(--nova-text) !important;
        }

        // Stat / Smart buttons
        .o-form-buttonbox {
            box-shadow: inset 0 -1px 0 var(--nova-border) !important;

            .oe_stat_button {
                border-left-color: var(--nova-border) !important;
                background: transparent !important;

                &:hover {
                    background: var(--nova-accent-light) !important;
                }

                > .o_button_icon {
                    color: var(--nova-text-tertiary) !important;
                }

                .o_stat_value {
                    color: var(--nova-text) !important;
                }

                .o_stat_text {
                    color: var(--nova-text-tertiary) !important;
                }
            }
        }

        // Status bar
        .o_form_statusbar {
            background-color: var(--nova-bg-alt) !important;
            border-color: var(--nova-border) !important;
        }

        // Totals area at bottom of form
        .oe_subtotal_footer {
            color: var(--nova-text) !important;
            border-top-color: var(--nova-border) !important;

            td {
                color: var(--nova-text) !important;
            }
        }
    }

    // ═══════════════════════════════════════════════════════════════════
    // CONTROL PANEL / PAGER (uses $o-view-background-color)
    // ═══════════════════════════════════════════════════════════════════

    .o_control_panel {
        background-color: var(--nova-surface) !important;
        border-color: var(--nova-border) !important;

        .o_cp_bottom,
        .o_cp_bottom_left,
        .o_cp_bottom_right {
            background-color: var(--nova-surface) !important;
            border-color: var(--nova-border) !important;
        }
    }

    .o_pager {
        color: var(--nova-text-secondary) !important;

        .o_pager_value {
            color: var(--nova-text) !important;
        }

        button {
            color: var(--nova-text-secondary) !important;

            &:hover {
                color: var(--nova-accent) !important;
            }
        }
    }

    // ═══════════════════════════════════════════════════════════════════
    // CHAT WINDOW (chat_window.scss: $o-mail-thread-window-bg: #FAFAFA)
    // ═══════════════════════════════════════════════════════════════════

    .o_ChatWindow {
        background-color: var(--nova-surface) !important;
        box-shadow: -5px -5px 10px rgba(0, 0, 0, 0.3) !important;

        .o_Composer {
            background-color: var(--nova-surface) !important;
            border-color: var(--nova-border) !important;

            textarea, input, .o_Composer_input {
                background-color: var(--nova-bg-alt) !important;
                color: var(--nova-text) !important;
                border-color: var(--nova-border) !important;
            }
        }

        .o_MessageList {
            background-color: var(--nova-bg) !important;
        }

        .o_ThreadView {
            background-color: var(--nova-bg) !important;
        }

        .o_Message {
            color: var(--nova-text) !important;
        }
    }

    // Chat header (uses CSS custom property)
    .o_ChatWindowHeader {
        --ChatWindowHeader-background-color: var(--nova-surface-raised);
        background-color: var(--nova-surface-raised) !important;
        color: var(--nova-text) !important;

        button {
            color: var(--nova-text-secondary) !important;

            &:hover {
                color: var(--nova-text) !important;
            }
        }
    }

    .o_ChatWindowHiddenMenu {
        background-color: var(--nova-surface) !important;
        border-color: var(--nova-border) !important;
        color: var(--nova-text) !important;
    }

    // ═══════════════════════════════════════════════════════════════════
    // GLOBAL BORDER & BACKGROUND CATCH-ALLS
    // ═══════════════════════════════════════════════════════════════════

    // bg-view utility (Bootstrap generated with !important — we need higher specificity)
    .bg-view {
        background-color: var(--nova-bg) !important;
    }

    .bg-100 {
        background-color: var(--nova-bg) !important;
    }

    .bg-200 {
        background-color: var(--nova-bg-alt) !important;
    }

    // All tables
    table, .table {
        --bs-table-bg: transparent;
        --bs-table-border-color: var(--nova-border);
        border-color: var(--nova-border) !important;
    }

    // Bootstrap border utilities
    .border {
        border-color: var(--nova-border) !important;
    }

    .border-bottom {
        border-bottom-color: var(--nova-border) !important;
    }

    .border-top {
        border-top-color: var(--nova-border) !important;
    }

    .border-start {
        border-left-color: var(--nova-border) !important;
    }

    .border-end {
        border-right-color: var(--nova-border) !important;
    }

    hr {
        border-color: var(--nova-border) !important;
    }

    // bg-xxx-light Bootstrap patterns
    .bg-info-light {
        background-color: var(--nova-info-light) !important;
    }

    .bg-success-light {
        background-color: var(--nova-success-light) !important;
    }

    .bg-warning-light {
        background-color: var(--nova-warning-light) !important;
    }

    .bg-danger-light {
        background-color: var(--nova-danger-light) !important;
    }

    // Chatter borders
    .o_Chatter {
        border-color: var(--nova-border) !important;
    }

    .o_ChatterTopbar {
        border-color: var(--nova-border) !important;
    }

    .o_ThreadView {
        background-color: var(--nova-bg) !important;
        border-color: var(--nova-border) !important;
    }

    // Message bubbles — note/notification backgrounds
    .o_Message .o_Message_background {
        border-color: var(--nova-border) !important;

        &.border-info, &.bg-info-light {
            background-color: var(--nova-info-light) !important;
            border-color: var(--nova-info) !important;
        }

        &.border-success, &.bg-success-light {
            background-color: var(--nova-success-light) !important;
            border-color: var(--nova-success) !important;
        }

        &.border-warning, &.bg-warning-light {
            background-color: var(--nova-warning-light) !important;
            border-color: var(--nova-warning) !important;
        }
    }

    // Discuss app
    .o_Discuss {
        background-color: var(--nova-bg) !important;

        .o_Discuss_sidebar {
            background-color: var(--nova-surface) !important;
            border-color: var(--nova-border) !important;
        }

        .o_Discuss_content {
            background-color: var(--nova-bg) !important;
        }
    }
}
